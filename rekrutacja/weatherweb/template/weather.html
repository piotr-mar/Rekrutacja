{% extends 'index.html' %}
{% load timetags %}

{% block content %}
<br>
<div class="container">
    <h5>Provide city name or coordinates to check weather</h5>
    <form action="" id="city_form" method="post">
        {% csrf_token %}
        {{form.as_p}}
        <button type="submit" name="city_form">Search</button>
    </form>
    <a href="{% url 'search' %}"><button type="reset" style="background-color: red; color: white" name="reset">Reset</button></a>
</div>
<br>
<br>
<br>
{% if data %}
<div class="container">
    <h3>City: {{ data.city }} </h3>
    <p>Date {{ data.weather.dt | convert_timestamp }}</p>
    Temp: {{ data.weather.main.temp }} {% if data.units == "metric" %} C {%else%} K {%endif%}<br>
    Temp feel: {{ data.weather.main.feels_like }} {% if data.units == "metric" %} C {%else%} K {%endif%}<br>
    Pressure: {{ data.weather.main.pressure }} hPa<br>
    Humidity: {{ data.weather.main.humidity }} %<br>
    Clouds: {{ data.weather.clouds.all }} %<br>
    Wind Speed: {{ data.weather.wind.speed }} {% if data.units == "metric" %} m/s {%else%} mil/h {%endif%}<br>
    {% if user.is_authenticated %}
    <div class="container">
        {% if data.user %}
        <button type="submit" form="city_form" name="favourite" disabled>Favourite</button>
        {% else %}
        <form action="" method="post">
            {% csrf_token %}
            <button type="submit" form="city_form" name="favourite">Add to Favourite</button>
        </form>
        {% endif %}
    </div>
    {% endif %}
</div>
<br>
{% if data.forecast %}
<h4>Forecast</h4>
<div class="container">
    <div class="container text-left">
        <div class="row">
            {% for day in data.forecast.list %}
            <div class="col">
                Date: {{ day.dt | convert_timestamp }}<br>
                Temp: {{ day.main.temp }} {% if data.units == "metric" %} C {%else%} K {%endif%}<br>
                Temp feel: {{ day.main.feels_like }} {% if data.units == "metric" %} C {%else%} K {%endif%}<br>
                Pressure: {{ day.main.pressure }} hPa<br>
                Humidity: {{ day.main.humidity }} %<br>
                Clouds: {{ day.clouds.all }} %<br>
                Wind Speed: {{ day.wind.speed }} {% if data.units == "metric" %} m/s {%else%} mil/h {%endif%}<br>

            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}
{% endif %}
{% endblock %}